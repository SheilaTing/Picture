{"version":3,"sources":["components/Tips.js","components/Uploader.js","pages/Home.js"],"names":["Tips","styled","div","Component","observer","children","userStore","useStores","currentUser","Result","H1","h1","Image","img","Dragger","Upload","imageStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","this","height","setHeight","serverFile","attributes","file","url","widthStr","heightStr","props","showUploadList","beforeUpload","setFile","setFilename","name","message","warning","upload","then","serverfile","console","log","catch","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Home","Uploader"],"mappings":"0UAOA,IAAMA,EAAOC,IAAOC,IAAV,KAuBKC,EAXGC,aAAS,YAAe,IAAbC,EAAY,EAAZA,SAClBC,EAAaC,cAAbD,UACP,OACI,oCAEQA,EAAUE,YAAc,KAAO,kBAACR,EAAD,KAAOK,O,qYCftD,IAAMI,EAASR,IAAOC,IAAV,KAMNQ,EAAKT,IAAOU,GAAV,KAKFC,EAAQX,IAAOY,IAAV,KAKHC,EAAYC,IAAZD,QAgHOX,EA7GGC,aAAS,WAAO,IAAD,EACKG,cAA1BD,EADqB,EACrBA,UAAWU,EADU,EACVA,WAEbC,EAAOC,mBACPC,EAAOD,mBAGPE,EAAQC,aAAc,iBAAO,CAC/BC,MAAO,KACPC,SAF+B,SAEtBD,GACLE,KAAKF,MAAQA,GAEjB,eACI,OAAOE,KAAKF,MAAL,aAAmBE,KAAKF,OAAU,IAE7CG,OAAQ,KACRC,UAT+B,SASrBD,GACND,KAAKC,OAASA,GAElB,gBACI,OAAOD,KAAKC,OAAL,aAAoBD,KAAKC,QAAW,IAE/C,cACI,OAAOT,EAAWW,WAAWC,WAAWC,KAAKD,WAAWE,IAAM,gBAAkBV,EAAMW,SAAWX,EAAMY,eAczGC,EAAQ,CACVC,gBAAgB,EAChBC,aAAc,SAAAN,GAIV,OAFAb,EAAWoB,QAAQP,GACnBb,EAAWqB,YAAYR,EAAKS,MACC,MAAzBhC,EAAUE,aACV+B,IAAQC,QAAQ,+CACT,IAEXxB,EAAWyB,SACNC,MAAK,SAACC,GACHC,QAAQC,IAAI,4BACZD,QAAQC,IAAIF,MACbG,OAAM,WACLF,QAAQC,IAAI,gCAIb,KAIf,OACI,6BACI,kBAAC/B,EAAYmB,EACT,uBAAGc,UAAU,wBACT,kBAACC,EAAA,EAAD,OAEJ,uBAAGD,UAAU,mBAAb,6CACA,uBAAGA,UAAU,mBAAb,2GAQA/B,EAAWW,WAAa,kBAAClB,EAAD,KACpB,kBAACC,EAAD,iCACA,4BACI,wDACA,4BACI,uBAAGuC,OAAO,SAASC,KAAMlC,EAAWW,WAAWC,WAAWC,KAAKD,WAAWE,KACrEd,EAAWW,WAAWC,WAAWC,KAAKD,WAAWE,MAG1D,kDACA,4BAAKd,EAAWmC,UAChB,wDACA,4BACI,kBAACvC,EAAD,CAAOwC,IAAKpC,EAAWW,WAAWC,WAAWC,KAAKD,WAAWE,OAEjE,wDACA,4BACI,2BAAOuB,IAAKpC,EAAMqC,SAhElB,WAEpBlC,EAAMG,SAASN,EAAKsC,QAAQC,QA8DqCC,YAAY,6BACzD,2BAAOJ,IAAKlC,EAAMmC,SA5DjB,WACrBlC,EAAMM,UAAUP,EAAKoC,QAAQC,QA2DqCC,YAAY,8BAG9D,4BACI,uBAAGR,OAAO,SAASC,KAAM9B,EAAMsC,SAAUtC,EAAMsC,YAG/C,SC1HtBC,EAAOvD,aAAS,WAGlB,OACI,oCACG,kBAAC,EAAD,qEACA,kBAACwD,EAAD,UAKID","file":"static/js/10.967de14d.chunk.js","sourcesContent":["import React from 'react';\r\nimport {useStores} from '../stores';\r\nimport styled from 'styled-components';\r\nimport {observer} from 'mobx-react';\r\n\r\n\r\n// 给 div 加样式\r\nconst Tips = styled.div`\r\n    padding:10px;\r\n    margin:30px 0;\r\n    color:#fff;\r\n    border-radius:5px;\r\n    background: orange;\r\n`;\r\n\r\n\r\n// {children} 可以获取到该组件中间的子元素\r\n// <component>{children}</component>\r\n//该组件中，我们判断用户是否登录,如果未登录给出提示\r\nconst Component = observer(({children})=>{\r\n    const {userStore} = useStores();\r\n    return (\r\n        <>\r\n            {\r\n                userStore.currentUser ? null : <Tips>{children}</Tips>\r\n            }\r\n        </>\r\n    )\r\n})\r\n\r\nexport default Component;","import React,{useRef} from 'react';\r\nimport { observer, useLocalStore } from 'mobx-react';\r\nimport { useStores } from '../stores';\r\nimport { Upload, message } from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from 'styled-components';\r\n\r\n//样式\r\n// 整个显示结果的容器样式\r\nconst Result = styled.div`\r\n    margin-top:30px;\r\n    border:1px dashed #cccResult;\r\n    padding:20px;\r\n`;\r\n//标题样式\r\nconst H1 = styled.h1`\r\n    text-align:center;\r\n    margin:20px 0;\r\n`;\r\n// 图片预览样式\r\nconst Image = styled.img`\r\n    max-width:300px;\r\n`;\r\n\r\n\r\nconst { Dragger } = Upload;\r\n\r\n//该组件实现上传图片ui,并根据用户是否登录做处理\r\nconst Component = observer(() => {\r\n    const { userStore, imageStore } = useStores();\r\n    //获取 input 输入的宽高\r\n    const ref1 = useRef();\r\n    const ref2 = useRef();\r\n    // 组件内部构建并使用 store\r\n    // 目的是 当设置宽高的input 内容发生变化时执行一个action 方法改变图片的url\r\n    const store = useLocalStore(() => ({\r\n        width: null,\r\n        setWidth(width) {\r\n            this.width = width;\r\n        },\r\n        get widthStr() {\r\n            return this.width ? `/w/${this.width}` : '';\r\n        },\r\n        height: null,\r\n        setHeight(height) {\r\n            this.height = height;\r\n        },\r\n        get heightStr() {\r\n            return this.height ? `/h/${this.height}` : '';\r\n        },\r\n        get fullStr() {\r\n            return imageStore.serverFile.attributes.file.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr;\r\n        }\r\n\r\n    }));\r\n\r\n    const bindWidthChange = ()=>{\r\n        // 设置 store 中的 宽度\r\n        store.setWidth(ref1.current.value);\r\n    };\r\n\r\n    const bindHeightChange = ()=>{\r\n        store.setHeight(ref2.current.value);\r\n    }\r\n\r\n    const props = {\r\n        showUploadList: false,  // 隐藏上传后的文件列表\r\n        beforeUpload: file => {\r\n            //调用 imageStore 中的上传方法\r\n            imageStore.setFile(file);\r\n            imageStore.setFilename(file.name);\r\n            if (userStore.currentUser == null) {\r\n                message.warning('请先登录再上传');\r\n                return false;\r\n            }\r\n            imageStore.upload()\r\n                .then((serverfile) => {\r\n                    console.log('上传成功');\r\n                    console.log(serverfile)\r\n                }).catch(() => {\r\n                    console.log('上传失败')\r\n                })\r\n            //return false 就不会自动上传,\r\n            //然后我们在该方法中定义我们自己的逻辑;\r\n            return false;\r\n        },\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Dragger {...props}>\r\n                <p className=\"ant-upload-drag-icon\">\r\n                    <InboxOutlined />\r\n                </p>\r\n                <p className=\"ant-upload-text\">Click or drag file to this area to upload</p>\r\n                <p className=\"ant-upload-hint\">\r\n                    Support for a single or bulk upload. Strictly prohibit from uploading company data or other\r\n                    band files\r\n                </p>\r\n            </Dragger>\r\n\r\n            {/* 根据imageStore 中是否有 serverFile 来展示上传结果 */}\r\n            {\r\n                imageStore.serverFile ? <Result>\r\n                    <H1>上传结果</H1>\r\n                    <dl>\r\n                        <dt>线上地址</dt>\r\n                        <dd>\r\n                            <a target=\"_blank\" href={imageStore.serverFile.attributes.file.attributes.url}>\r\n                                {imageStore.serverFile.attributes.file.attributes.url}\r\n                            </a>\r\n                        </dd>\r\n                        <dt>文件名</dt>\r\n                        <dd>{imageStore.filename}</dd>\r\n                        <dt>图片预览</dt>\r\n                        <dd>\r\n                            <Image src={imageStore.serverFile.attributes.file.attributes.url}></Image>\r\n                        </dd>\r\n                        <dt>更多尺寸</dt>\r\n                        <dd>\r\n                            <input ref={ref1} onChange={bindWidthChange} placeholder=\"图片宽度\" />\r\n                            <input ref={ref2} onChange={bindHeightChange} placeholder=\"图片高度\" />\r\n                        </dd>\r\n                        {/* 加上宽高后的完整路径 */}\r\n                        <dd>\r\n                            <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\r\n                        </dd>\r\n                    </dl>\r\n                </Result> : null\r\n            }\r\n\r\n\r\n        </div>\r\n    )\r\n})\r\n\r\n\r\nexport default Component;","import React from 'react';\r\nimport {useStores} from '../stores';\r\nimport {observer} from 'mobx-react';\r\nimport Tips from '../components/Tips';\r\nimport Uploader from '../components/Uploader';\r\n\r\nconst Home = observer(()=>{\r\n\r\n\r\n    return(\r\n        <>\r\n           <Tips>请先登录再上传！！！</Tips>\r\n           <Uploader /> \r\n        </>\r\n    )\r\n})\r\n\r\nexport default Home;"],"sourceRoot":""}